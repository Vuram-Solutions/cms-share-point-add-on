{"version":3,"file":"taskpane.js","mappings":"yBACA,IAAIA,EAAsB,G,4TCA1BA,EAAoBC,EAAI,SAASC,EAASC,GACzC,IAAI,IAAIC,KAAOD,EACXH,EAAoBK,EAAEF,EAAYC,KAASJ,EAAoBK,EAAEH,EAASE,IAC5EE,OAAOC,eAAeL,EAASE,EAAK,CAAEI,YAAY,EAAMC,IAAKN,EAAWC,MCJ3EJ,EAAoBK,EAAI,SAASK,EAAKC,GAAQ,OAAOL,OAAOM,UAAUC,eAAeC,KAAKJ,EAAKC,ICO/FI,OAAOC,SAAQ,SAACC,GACVA,EAAKC,OAASH,OAAOI,SAASC,OAClCC,SAASC,eAAe,gBAAgBC,MAAMC,QAAU,OACxDH,SAASC,eAAe,YAAYC,MAAMC,QAAU,OACpDH,SAASC,eAAe,YAAYG,iBAAiB,SAAUC,GAC/DC,EAAE,SAASC,OAAOF,OAGpB,IAIIG,EAIAC,EARAC,EAAe,wDACbC,EACJ,mJACEC,EAAgB,GAEhBC,EAAS,EACTC,EAAgB,EAChBC,EAAS,GAIN,SAASV,EAAWW,GAEL,KADpBR,EAAeQ,EAAMC,OAAOC,QAE1BlB,SAASC,eAAe,cAAckB,YAAc,uBACpDC,IACAC,GAAiB,GAuNnBrB,SAASC,eAAe,kBAAkBC,MAAMC,QAAU,SApNxDU,EAAS,EA8MXb,SAASC,eAAe,kBAAkBC,MAAMC,QAAU,QAC1DH,SAASC,eAAe,kBAAkBG,iBAAiB,QAASkB,GACpEtB,SAASC,eAAe,kBAAkBG,iBAAiB,UAAWmB,GA9MpEvB,SAASC,eAAe,UAAUiB,MAAQ,GAC1ClB,SAASC,eAAe,UAAUC,MAAMC,QAAU,OAClDH,SAASC,eAAe,cAAckB,YAAc,GACpDK,EAAYd,EAAc,QAAUF,EAAe,WAAaK,GAAQY,MAAK,SAACC,GAC5EC,IACID,EAAKE,MACPR,KAEAS,EAAQH,GACRL,GAAiB,QAgDzB,SAASM,IACPf,EAAgB,GAGlB,SAASQ,IACPO,IACA3B,SAASC,eAAe,WAAWC,MAAMC,QAAU,OACnDH,SAASC,eAAe,QAAQ6B,UAAY,GAC5C9B,SAASC,eAAe,UAAUC,MAAMC,QAAU,OAOpD,SAAS0B,EAAQH,GACVA,EAAKE,QACJF,EAAKK,OAAOC,OAAS,GACvBlB,EAAgBY,EAAKO,WAAa,GAAKpB,EAEvCa,EAAKK,OAAOG,KAAI,SAACC,GAAD,OAAUvB,EAAcwB,KAAKD,MA5DjDnC,SAASC,eAAe,QAAQ6B,UAAY,GAC5C9B,SAASC,eAAe,UAAUC,MAAMC,QAAU,OAClDS,EAAcsB,KAAI,SAACC,GACjB,IAAIE,EAAUrC,SAASsC,cAAc,OACrCD,EAAQE,UAAY,UAEpB,IAAIC,EAAcxC,SAASsC,cAAc,OACzCE,EAAYD,UAAY,OACxBC,EAAYC,GAAKN,EAAKM,GACtBD,EAAYE,UAAYP,EAAKQ,KAE7B,IAAIC,EAAU5C,SAASsC,cAAc,UACrCM,EAAQH,GAAKN,EAAKM,GAClBG,EAAQF,UAAY,IACpBE,EAAQC,aAAa,iBAAkBV,EAAKQ,MAC5CC,EAAQE,MAAQ,gBAChBF,EAAQL,UAAY,eACpBF,EAAQU,YAAYP,GACA,aAAhBhC,GACFoC,EAAQxC,iBAAiB,QAAS4C,GAClCX,EAAQU,YAAYH,KAEpBJ,EAAYpC,iBAAiB,QAAS6C,GACtCL,EAAQxC,iBAAiB,QAAS8C,GAClCb,EAAQU,YAAYH,IAItB5C,SAASC,eAAe,QAAQ8C,YAAYV,MAI1CvB,EAAgB,GAClBd,SAASC,eAAe,WAAWC,MAAMC,QAAU,QACnDH,SAASC,eAAe,WAAWG,iBAAiB,QAAS+C,IAE7DnD,SAASC,eAAe,WAAWC,MAAMC,QAAU,QA2BjDiB,K,SAKSI,EAAY,EAAZA,G,gFAAf,WAA2B4B,EAAKC,GAAhC,wGACuBC,MAAMF,EAAMC,EAAQ,CACvCE,KAAM,OACNC,OAAQ,MACRC,QAAS,CACP,iBAAkB9C,EAClB,eAAgB,uCAElB+C,eAAgB,6BARpB,cACMC,EADN,gBAUmBA,EAASC,OAV5B,cAUMlC,EAVN,yBAWSA,GAXT,4C,sBAqBO,SAASyB,EAASnC,GACvBhB,SAASC,eAAe,WAAWC,MAAMC,QAAU,OACnDH,SAASC,eAAe,cAAcC,MAAMC,QAAU,OAEtDqB,EAAYd,EAAc,QAAUF,EAAe,YADnDK,GAAU,GAC+D,WAAaE,GACnFU,MAAK,SAACC,GAELG,EAAQH,GACR1B,SAASC,eAAe,WAAWC,MAAMC,QAAU,QACnDH,SAASC,eAAe,cAAcC,MAAMC,QAAU,UAEvD0D,OAAM,SAACC,GAAD,OAASC,QAAQC,IAAIF,MAGhC,SAASb,EAAUjC,GACjBhB,SAASC,eAAe,aAAaC,MAAMC,QAAU,OACrDH,SAASC,eAAe,UAAUC,MAAMC,QAAU,OAClD,IAAIsC,EAAKzB,EAAMC,OAAOwB,GACtBjB,EAAYd,EAAc,MAAQ+B,EAAK,SAAWjC,GAAciB,MAAK,SAACwC,GAzBxE,IAAwBvC,EAAAA,EA0BLuC,EAzBjBjE,SAASC,eAAe,YAAYyC,UAAYhB,EAAKiB,KACrD3C,SAASC,eAAe,eAAe6B,UAAYJ,EAAKwC,QACxDlE,SAASC,eAAe,cAAcG,iBAAiB,QAAS+D,GAChEnE,SAASC,eAAe,aAAaG,iBAAiB,QAASgE,GAuB7DpE,SAASC,eAAe,kBAAkBC,MAAMC,QAAU,OAC1DH,SAASC,eAAe,UAAUC,MAAMC,QAAU,OAClDH,SAASC,eAAe,eAAeC,MAAMC,QAAU,WAIpD,SAAS+C,EAAQlC,GACtB+C,QAAQC,IAAIhD,EAAMC,OAAOwB,IACzB,IAAIA,EAAKzB,EAAMC,OAAOwB,GACtBjB,EAAYd,EAAc,MAAQ+B,EAAK,SAAWjC,GAAciB,MAAK,SAACC,GAEpE,IAAIc,EAAcxC,SAASsC,cAAc,OACzCE,EAAYV,UAAUJ,EAAKwC,QAC3B,IAAIA,EAAU1B,EAAYE,UAC1BqB,QAAQC,IAAIE,GAMZG,EAAuBH,MAI3B,SAASlB,EAAahC,GACpB,IAAIU,EAAOV,EAAMC,OAAOqD,aAAa,kBAErC5C,EAAO,OADPA,EAAOA,EAAK6C,QAAQ,KAAM,MACJ,MACtBR,QAAQC,IAAItC,GAMZ2C,EAAuB3C,GAGlB,SAAS0C,IAGdC,EAAuBrE,SAASC,eAAe,eAAekB,aAC9D4C,QAAQC,IAAIhE,SAASC,eAAe,eAAekB,aAG9C,SAASgD,IACdnE,SAASC,eAAe,kBAAkBC,MAAMC,QAAU,QAC1DH,SAASC,eAAe,aAAaC,MAAMC,QAAU,QACrDH,SAASC,eAAe,eAAeC,MAAMC,QAAU,OAGlD,SAASmB,IACdtB,SAASC,eAAe,UAAUC,MAAMC,QAAU,OAClDH,SAASC,eAAe,aAAaC,MAAMC,QAAU,OACrDqE,aAAa/D,GACbA,EAAcgE,WAAWC,EAhMF,MAmMlB,SAASnD,IACdiD,aAAa/D,GAGf,SAASiE,IACP3D,EAASf,SAASC,eAAe,UAAUiB,MAE3CN,EAAgB,GAEhBY,EAAYd,EAAc,QAAUF,EAAe,YAHnDK,EAAS,GAGgE,WAAaE,GAAQU,MAAK,SAACC,GAElGG,EAAQH,GACR1B,SAASC,eAAe,aAAaC,MAAMC,QAAU,WAIzD,SAASkB,EAAiBsD,GACxB3E,SAASC,eAAe,UAAU2E,SAAWD,EAaxC,SAAeN,EAAtB,kC,iDAAO,WAAsCQ,GAAtC,yGACE9E,KAAK+E,IAAL,4CAAS,WAAOC,GAAP,uFACIA,EAAQ/E,SAASgF,eAAeC,WAAWJ,EAAM9E,KAAKmF,eAAeC,OADzE,SAERJ,EAAQK,OAFA,2CAAT,wDADF,2C","sources":["webpack:///webpack/bootstrap?","webpack:///webpack/runtime/define property getters?","webpack:///webpack/runtime/hasOwnProperty shorthand?","webpack:///./src/taskpane/taskpane.js?"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","/*\n * Copyright (c) Microsoft Corporation. All rights reserved. Licensed under the MIT license.\n * See LICENSE in the project root for license information.\n */\n\n/* global document, Office, Word */\n\nOffice.onReady((info) => {\n  if (info.host === Office.HostType.Word) {\n  document.getElementById(\"sideload-msg\").style.display = \"none\";\n  document.getElementById(\"app-body\").style.display = \"flex\";\n  document.getElementById(\"app-body\").addEventListener(\"change\", typeChange);\n  $(\"#type\").change(typeChange)\n  }\n});\nvar cmsSerachApi = \"https://souldev.vuram.com/suite/webapi/clausedetails?\";\nconst api_key =\n  \"eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJjNzhiNmI3Yy0zOTM1LTRlNzYtOTNiYy02NzRiZDIyOTliMjIifQ. y7eWaJJnVn2FXLJzGTiKkkyg_2JmtVHTAtB54raAlvg\";\nvar listToDisplay = [];\nvar selectedType;\nvar pageNo = 1;\nvar remainingItem = 0;\nvar filter = \"\";\nvar typingTimer;\nvar doneTypingInterval = 2500;\n\nexport function typeChange(event) {\n  selectedType = event.target.value;\n  if (selectedType == \"\") {\n    document.getElementById(\"type-error\").textContent = \"Please select a type\";\n    setEmptyList();\n    setDisableFilter(true);\n    hideFilter();\n  } else {\n    pageNo = 1;\n    showFilter();\n    document.getElementById(\"filter\").value = \"\";\n    document.getElementById(\"loader\").style.display = \"grid\";\n    document.getElementById(\"type-error\").textContent = \"\";\n    makeApiCall(cmsSerachApi, \"type=\" + selectedType + \"&pageNo=\" + pageNo).then((data) => {\n      clearList();\n      if (data.error) {\n        setEmptyList();\n      } else {\n        setList(data);\n        setDisableFilter(false);\n      }\n    });\n    // console.log(event.target.value)\n  }\n}\n\nfunction setListHtml() {\n  document.getElementById(\"list\").innerHTML = \"\";\n  document.getElementById(\"loader\").style.display = \"none\";\n  listToDisplay.map((item) => {\n    var itemdiv = document.createElement(\"div\");\n    itemdiv.className = \"itemDiv\";\n\n    var itemContent = document.createElement(\"div\");\n    itemContent.className = \"item\";\n    itemContent.id = item.id;\n    itemContent.innerText = item.name;\n\n    var itemBtn = document.createElement(\"button\");\n    itemBtn.id = item.id;\n    itemBtn.innerText = \"+\";\n    itemBtn.setAttribute(\"data-parameter\", item.name);\n    itemBtn.title = \"Add Parameter\";\n    itemBtn.className = \"addItem-btn \";\n    itemdiv.appendChild(itemContent);\n    if (selectedType == \"Parameter\") {\n      itemBtn.addEventListener(\"click\", addParameter);\n      itemdiv.appendChild(itemBtn);\n    }else{\n      itemContent.addEventListener(\"click\", itemClick);\n      itemBtn.addEventListener(\"click\", addItem);\n      itemdiv.appendChild(itemBtn);\n    }\n\n    \n    document.getElementById(\"list\").appendChild(itemdiv);\n    // console.log(item);\n  });\n\n  if (remainingItem > 0) {\n    document.getElementById(\"loadBtn\").style.display = \"block\";\n    document.getElementById(\"loadBtn\").addEventListener(\"click\", loadMore);\n  } else {\n    document.getElementById(\"loadBtn\").style.display = \"none\";\n  }\n}\n\nfunction clearList() {\n  listToDisplay = [];\n}\n\nfunction setEmptyList() {\n  clearList();\n  document.getElementById(\"loadBtn\").style.display = \"none\";\n  document.getElementById(\"list\").innerHTML = \"\";\n  document.getElementById(\"loader\").style.display = \"none\";\n  // const noItem = document.createElement('div')\n  // noItem.id = \"noitems\"\n  // noItem.innerText = \"No items available...!\"\n  // document.getElementById('list').appendChild(noItem)\n}\n\nfunction setList(data) {\n  if (!data.error) {\n    if (data.values.length > 0) {\n      remainingItem = data.totalCount - 20 * pageNo;\n      // listToDisplay.\n      data.values.map((item) => listToDisplay.push(item));\n      setListHtml();\n    } else {\n      setEmptyList();\n    }\n  }\n}\n\nasync function makeApiCall(url, queury) {\n  var response = await fetch(url + queury, {\n    mode: \"cors\",\n    method: \"GET\",\n    headers: {\n      \"appian-api-key\": api_key,\n      \"content-type\": \"application/json;charset=ISO-8859-1\",\n    },\n    referrerPolicy: \"origin-when-cross-origin\",\n  });\n  var data = await response.json();\n  return data;\n}\n\nfunction setItemContent(data) {\n  document.getElementById(\"itemName\").innerText = data.name;\n  document.getElementById(\"itemDetails\").innerHTML = data.content;\n  document.getElementById(\"backButton\").addEventListener(\"click\", back);\n  document.getElementById(\"addButton\").addEventListener(\"click\", insertContent);\n}\n\nexport function loadMore(event) {\n  document.getElementById(\"loadBtn\").style.display = \"none\";\n  document.getElementById(\"loadingbtn\").style.display = \"flex\";\n  pageNo += 1;\n  makeApiCall(cmsSerachApi, \"type=\" + selectedType + \"&pageNo=\" + pageNo + \"&filter=\" + filter)\n    .then((data) => {\n      // console.log(data);\n      setList(data);\n      document.getElementById(\"loadBtn\").style.display = \"block\";\n      document.getElementById(\"loadingbtn\").style.display = \"none\";\n    })\n    .catch((err) => console.log(err));\n}\n\nfunction itemClick(event) {\n  document.getElementById(\"itemsBody\").style.display = \"none\";\n  document.getElementById(\"loader\").style.display = \"grid\";\n  var id = event.target.id;\n  makeApiCall(cmsSerachApi, \"id=\" + id + \"&type=\" + selectedType).then((result) => {\n    setItemContent(result);\n    document.getElementById(\"clauseContents\").style.display = \"none\";\n    document.getElementById(\"loader\").style.display = \"none\";\n    document.getElementById(\"itemContent\").style.display = \"block\";\n  });\n}\n\nexport function addItem(event) {\n  console.log(event.target.id)\n  var id = event.target.id;\n  makeApiCall(cmsSerachApi, \"id=\" + id + \"&type=\" + selectedType).then((data) => {\n    // console.log(data.content);\n    var itemContent = document.createElement('div');\n    itemContent.innerHTML=data.content;\n    var content = itemContent.innerText;\n    console.log(content);\n\n    // for google docs add on\n    // google.script.run.insertText(content)\n\n    // for sharepoint add on \n    insertTextIntoDocument(content);\n  });\n}\n\nfunction addParameter(event) {\n  var data = event.target.getAttribute(\"data-parameter\");\n  data = data.replace(/ /g, \"_\");\n  data = \"###\" + data + \"###\";\n  console.log(data);\n\n   // for google docs add on\n  // google.script.run.insertText(data)\n\n  // for sharepoint add on \n  insertTextIntoDocument(data);\n}\n\nexport function insertContent() {\n\n  // google.script.run.insertText(document.getElementById('itemDetails').textContent)\n  insertTextIntoDocument(document.getElementById(\"itemDetails\").textContent);\n  console.log(document.getElementById(\"itemDetails\").textContent);\n}\n\nexport function back() {\n  document.getElementById(\"clauseContents\").style.display = \"block\";\n  document.getElementById(\"itemsBody\").style.display = \"block\";\n  document.getElementById(\"itemContent\").style.display = \"none\";\n}\n\nexport function inputStarted() {\n  document.getElementById(\"loader\").style.display = \"grid\";\n  document.getElementById(\"itemsBody\").style.display = \"none\";\n  clearTimeout(typingTimer);\n  typingTimer = setTimeout(doneTyping, doneTypingInterval);\n}\n\nexport function inputEnded() {\n  clearTimeout(typingTimer);\n}\n\nfunction doneTyping() {\n  filter = document.getElementById(\"filter\").value;\n  pageNo = 1;\n  listToDisplay = [];\n  // console.log(dummy);\n  makeApiCall(cmsSerachApi, \"type=\" + selectedType + \"&pageNo=\" + pageNo + \"&filter=\" + filter).then((data) => {\n    // console.log(data);\n    setList(data);\n    document.getElementById(\"itemsBody\").style.display = \"block\";\n  });\n}\n\nfunction setDisableFilter(val) {\n  document.getElementById(\"filter\").disabled = val;\n}\n\nfunction showFilter() {\n  document.getElementById(\"filterSelected\").style.display = \"block\";\n  document.getElementById(\"filterSelected\").addEventListener(\"keyup\", inputStarted);\n  document.getElementById(\"filterSelected\").addEventListener(\"keydown\", inputEnded);\n}\n\nfunction hideFilter() {\n  document.getElementById(\"filterSelected\").style.display = \"none\";\n}\n\nexport async function insertTextIntoDocument(text) {\n  return Word.run(async (context) => {\n    const paragraph = context.document.getSelection().insertText(text, Word.InsertLocation.after);\n    await context.sync();\n  });\n}\n"],"names":["__webpack_require__","d","exports","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","Office","onReady","info","host","HostType","Word","document","getElementById","style","display","addEventListener","typeChange","$","change","selectedType","typingTimer","cmsSerachApi","api_key","listToDisplay","pageNo","remainingItem","filter","event","target","value","textContent","setEmptyList","setDisableFilter","inputStarted","inputEnded","makeApiCall","then","data","clearList","error","setList","innerHTML","values","length","totalCount","map","item","push","itemdiv","createElement","className","itemContent","id","innerText","name","itemBtn","setAttribute","title","appendChild","addParameter","itemClick","addItem","loadMore","url","queury","fetch","mode","method","headers","referrerPolicy","response","json","catch","err","console","log","result","content","back","insertContent","insertTextIntoDocument","getAttribute","replace","clearTimeout","setTimeout","doneTyping","val","disabled","text","run","context","getSelection","insertText","InsertLocation","after","sync"],"sourceRoot":""}